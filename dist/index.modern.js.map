{"version":3,"file":"index.modern.js","sources":["../src/getTorrent.tsx","../src/index.tsx"],"sourcesContent":["/* eslint-disable one-var */\n/* eslint-disable prefer-const */\n// eslint-disable-next-line no-unused-vars\nimport WebTorrent, { Torrent } from 'webtorrent'\nconst client = new WebTorrent()\n\n// TODO: allow build to send file folders to nginx running with volumes mounted that get updated when sent to server\n// Make a service that gives you a .com address and then serves your webpack static code from a nginx server\n// just needs a simple template structure index.html, dist and such\n\nclient.on('error', function (t) {\n  console.log('err', t)\n})\n\nexport const GetTorrent = (\n  magnetURI: string | { default: string },\n  manageTor: (file: WebTorrent.Torrent) => void\n) => {\n  if (typeof magnetURI !== 'string') {\n    magnetURI = magnetURI.default\n  }\n  let torrentCheck = client.get(magnetURI)\n  if (torrentCheck) {\n    let torrent = torrentCheck\n    if (torrent.name) {\n      manageTor(torrent)\n    } else {\n      client.on('torrent', function (t: WebTorrent.Torrent) {\n        if (torrent?.infoHash === t?.infoHash) {\n          manageTor(t)\n        }\n      })\n    }\n  } else {\n    client.add(magnetURI, function (torrent: WebTorrent.Torrent) {\n      manageTor(torrent)\n    })\n  }\n}\n\nexport const loopThroughTorFiles = (\n  torrent: Torrent,\n  manageFile: (file: WebTorrent.TorrentFile) => void\n) => {\n  torrent.files.forEach((file: WebTorrent.TorrentFile) => {\n    manageFile(file)\n  })\n}\n\nexport const PromiseTorrent = (magnetURI: string | { default: string }) => {\n  return new Promise((resolve: (file: WebTorrent.Torrent) => void) => {\n    if (typeof magnetURI !== 'string') {\n      magnetURI = magnetURI.default\n    }\n    let torrentCheck = client.get(magnetURI)\n    if (torrentCheck) {\n      let torrent = torrentCheck\n      if (torrent.name) {\n        resolve(torrent)\n      } else {\n        client.on('torrent', function (t: WebTorrent.Torrent) {\n          if (torrent?.infoHash === t?.infoHash) {\n            resolve(t)\n          }\n        })\n      }\n    } else {\n      client.add(magnetURI, function (torrent: WebTorrent.Torrent) {\n        resolve(torrent)\n      })\n    }\n  })\n}\n","/* eslint-disable one-var */\n/* eslint-disable prefer-const */\nimport * as React from 'react'\nimport { Fragment, useEffect, useState, useRef } from 'react'\n// eslint-disable-next-line no-unused-vars\nimport WebTorrent from 'webtorrent'\nimport { GetTorrent, loopThroughTorFiles, PromiseTorrent } from './getTorrent'\n\nexport const getTorrent = GetTorrent\nexport const promiseTorrent = PromiseTorrent\n\nexport const ImgATor = (props: any) => {\n  let [fileState, updateFile] = useState<WebTorrent.TorrentFile>(),\n    [urlState, updateUrl] = useState<string>(),\n    manageFile = (file: WebTorrent.TorrentFile) => {\n      // TODO: this better with more file types and upper and lower cases\n      updateFile(file)\n      file.getBlobURL((err, url) => {\n        if (err) throw err\n        updateUrl(url)\n      })\n    },\n    mngTor = (torrent: WebTorrent.Torrent) => {\n      loopThroughTorFiles(torrent, manageFile)\n    }\n\n  useEffect(() => {\n    PromiseTorrent(props.magnetLink).then(mngTor)\n    return () => {}\n  }, [])\n  return (\n    <Fragment>\n      <img\n        src={urlState}\n        alt={fileState?.name}\n        width={props.width}\n        height={props.height}\n        sizes={props.sizes}\n        style={props.style}\n      />\n    </Fragment>\n  )\n}\n\nexport const VidATor = (props: any) => {\n  const videoElement = useRef(null)\n  let [fileState, updateFile] = useState<WebTorrent.TorrentFile>(),\n    [urlState, updateUrl] = useState<string>(),\n    manageFile = (file: WebTorrent.TorrentFile) => {\n      // TODO: this better with more file types and upper and lower cases\n      if (file.name.includes('.mp4')) {\n        updateFile(file)\n        file.getBlobURL((err, url) => {\n          if (err) throw err\n          updateUrl(url)\n        })\n      }\n    },\n    mngTor = (torrent: WebTorrent.Torrent) => {\n      loopThroughTorFiles(torrent, manageFile)\n    }\n\n  useEffect(() => {\n    PromiseTorrent(props.magnetLink).then(mngTor)\n    return () => {}\n  }, [])\n  return (\n    <Fragment>\n      {urlState ? null : <h2 style={{ color: 'orange' }}>Loading</h2>}\n      <video\n        // poster='loading.gif' // TODO: make this loading gif work\n        width={props.width}\n        height={props.height}\n        controls\n        autoPlay\n        muted\n        ref={videoElement}\n        src={urlState}\n      >\n        <source type={props.type} />\n        Your browser does not support the video tag.{fileState?.name}\n      </video>\n    </Fragment>\n  )\n}\n\nexport const VidStrmATor = (props: any) => {\n  const videoElement = useRef(null)\n  const opts = {\n    autoplay: props.autoplay,\n    muted: true\n  }\n  let manageFile = (file: WebTorrent.TorrentFile) => {\n      // TODO: this better with more file types and upper and lower cases\n      if (file.name.includes('.mp4')) {\n        // @ts-ignore: Object is possibly 'null'.\n        file.renderTo(videoElement.current, opts, function (err, elem) {\n          if (err) throw err // file failed to download or display in the DOM\n          console.log('New DOM node with the content', elem)\n        })\n      }\n    },\n    mngTor = (torrent: WebTorrent.Torrent) => {\n      loopThroughTorFiles(torrent, manageFile)\n    }\n\n  useEffect(() => {\n    PromiseTorrent(props.magnetLink).then(mngTor)\n    return () => {}\n  }, [])\n  return (\n    <Fragment>\n      <video\n        width={props.width}\n        height={props.height}\n        controls\n        muted\n        ref={videoElement}\n      >\n        <source type='video/mp4' />\n        Your browser does not support the video tag.\n      </video>\n    </Fragment>\n  )\n}\n\nexport const WrapATor = (props: any) => {\n  const { children } = props\n  let [childElements, updateChildElements] = useState<any>(),\n    mngTor = (torrent: WebTorrent.Torrent) => {\n      const chldElements = React.Children.map(children, (child) =>\n        React.cloneElement(child, {\n          torrent: torrent\n        })\n      )\n      updateChildElements(chldElements)\n    }\n\n  useEffect(() => {\n    PromiseTorrent(props.magnetLink).then(mngTor)\n    return () => {}\n  }, [])\n\n  return <Fragment>{childElements}</Fragment>\n}\n\nexport const WrappedImgATor = (props: any) => {\n  let [fileState, updateFile] = useState<WebTorrent.TorrentFile>(),\n    [urlState, updateUrl] = useState<string>(),\n    manageFile = (file: WebTorrent.TorrentFile) => {\n      // TODO: this better with more file types and upper and lower cases\n      updateFile(file)\n      file.getBlobURL((err, url) => {\n        if (err) throw err\n        updateUrl(url)\n      })\n    },\n    mngTor = (torrent: WebTorrent.Torrent) => {\n      loopThroughTorFiles(torrent, manageFile)\n    }\n\n  useEffect(() => {\n    mngTor(props.torrent)\n    return () => {}\n  }, [])\n  return (\n    <Fragment>\n      <img\n        src={urlState}\n        alt={fileState?.name}\n        width={props.width}\n        height={props.height}\n        sizes={props.sizes}\n        style={props.style}\n      />\n    </Fragment>\n  )\n}\n\n// https://stackoverflow.com/questions/51657890/is-it-ok-to-use-a-wrapper-component-to-pass-props-in-react\n"],"names":["client","WebTorrent","on","t","console","log","GetTorrent","magnetURI","manageTor","torrentCheck","get","torrent","name","infoHash","add","loopThroughTorFiles","manageFile","files","forEach","file","PromiseTorrent","Promise","resolve","getTorrent","promiseTorrent","ImgATor","props","useState","fileState","updateFile","urlState","updateUrl","getBlobURL","err","url","mngTor","useEffect","magnetLink","then","React","Fragment","src","alt","width","height","sizes","style","VidATor","videoElement","useRef","includes","color","controls","autoPlay","muted","ref","type","VidStrmATor","opts","autoplay","renderTo","current","elem","WrapATor","children","childElements","updateChildElements","chldElements","map","child","WrappedImgATor"],"mappings":"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"}